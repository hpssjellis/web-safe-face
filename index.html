
<!--   *******************************Start: What source js file to use? ****************************************************   -->



<!-- the online version that these examples were made with  -->

<!-- <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.13.1"></script>  -->


<script src="https://cdn.jsdelivr.net/npm/three@0.117.1/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/scatter-gl@0.0.5/lib/scatter-gl.min.js"></script> 
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/facemesh@0.0.3"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-wasm@2.0.0/dist/tf-backend-wasm.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/knn-classifier@0.2.2"></script>    <!-- 1.2.6  -->


<!-- the newest version script tag is below but by using it all the examples may not work 

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>

-->



<!-- Or you could download the newest version, save it as myNewDownloadedTensorflow.js and use the link below and work completely offline using a tag similar to


<script src="myNewDownloadedTensorflow.js"></script>

-->

 <!-- Note: often nice to load the readable version of the src file. Remember to match the numbers to whatever the newest version is.

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.13.0/dist/tf.js"></script>

--> 



<!--   *******************************Stop: What source js file to use? ****************************************************   -->



    
    
<h2 align=center> As easy as I can make Loading Tensorflowjs KNN-Classifier Demo </h2>








<div style="font-size:15px; background-color:lightyellow; width:88%;  border:5px solid blue; padding:5px; margin:5px;"> 
 Online demo of the very interesting <a href="https://github.com/tensorflow/tfjs-models/tree/master/knn-classifier">KNN-Classifier </a> 
 Github in the <a href="https://github.com/tensorflow/tfjs-models">TFJS-models </a> repository<br><br>
 
KNN-Classifier takes a Deep Learning model and uses K-Nearest-Neighbor analysis to it. So you can, from a website, 
live "Train" objects from the model and get results at the same time! <br>
 
 This time we are going to use <a href="https://github.com/justadudewhohacks/face-api.js">face-api.js</a> to run a 68 point face detection
 model then train the knn-classifier on people. Kind of fun to google celebrities for training then check out the rest of us. The KNN classifier
 will detect the closest celebrity.<br><br>
 I am looking into how to save the knn-classfier data with labels. <br><br>
 Data from:
 
 <a href="https://www.imdb.com/list/ls000760476/">https://www.imdb.com/list/ls000760476/</a>
 
</div><br>


<div id="myDiv123Code"> 


  <!--

<script src="face-api.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/knn-classifier@0.2.2"></script> 
    
-->




  
<input type=button value="Load Face-api.js face_landmark_68_tiny_model"style="background-color:lime"  onclick="{
   myRunFace() 
}"><br><br>



<select size=1 id="myCheck">
 <option value='environment'>Rear Mobile Camera
 <option value='user'>Front Mobile Camera
</select>

<input type=button id="myButtonActivateWebCam" value="Activate WebCam" onclick="{getVideo()}"> 
<input type=button id="myButtonActivateWebCam" value="Stop WebCam" onclick="{ stopVideo()  }"> <br><br>
 
 Train a few items with a group number and a text label<br>
<input type=button value="Train. Get close, no bounding box used" onclick="{myNewTrain()}"> 
<input type=number value=0 size=3 id="myClassNumber" onchange = "{
   myTextChange()                                                       
}">
<input type=text id="myClassText" placeholder="Label for this trained class: example Cell Phone" value="Joe Smith"><br><br>

 
<input type=button value="Save Classifier" onclick="{myClassifierSave()}"> <br><br>
 
<input type=text id="myInFile" size=120 value="models/myClassifierModel01.json"> <br>

<input type=button value="Load Classifier" onclick="{myClassifierLoad()}"> 
 
 

 
<video  id="myVideoElement" width="320" height="320" style="display:inline; border: 1px solid #ddd;" title="myVideoElement: WebCam-Live"></video>
<canvas id="my32x32CanvasA"  width="320" height="320" style="display:inline; border: 1px solid #ddd;  interpolation-mode: nearest-neighbor;" title="my32x32CanvasA: interval snapshots, presently for training"></canvas><br>

<canvas id="myFaceCanvas" width="320" height="320"  style="border: 1px solid #ddd;" title="myFaceCanvas: Zoomed in face"></canvas>
<canvas id="myVideoAsCanvas" width="320" height="320" style="border: 1px solid #ddd;" title="myVideoAsCanvas: back layer"></canvas>
<canvas id="myBorderAsCanvas" style="position:relative; left:-325px" title="myBorderAsCanvas: Layer with box, in front of myVideoAsCanvas interval snapshot"></canvas><br>

<div id="myDivLoss">...</div><br> 
 
 
 <br><br>


Analyse every <input type=number id="myInterval"  value="500" size=5> milliseconds<br>
<input type=button id="myButtonAuto" value="Auto" onclick="{takeAuto()}"> 
<input type=button value="Stop Auto" onclick="{myStopAuto()}"><br><br>

<div id="myDivTest">...</div><br>
<div id="myDiv01">...</div><br>


 
<div id="myDivSummary">...</div><br><br>


<input type=button value="Load Group" onclick="{
   myLoadManyImages()                                              
}">
 <input type=button value="Check Training" onclick="{
  myCheckGroups()                                                                                                 
}">
 
 <input type=button value="Google Search" onclick="{
   myShowInfo()                                              
}"> 
  <input type=button value="Google Search and open" onclick="{
   myShowInfo2()                                              
}"> 
 
 
 <br>
To get faces use google search but set "tools" from "Not filtered by License" to "Labelled for reuse" I also set "any Size" to "medium"<br>
 <textarea id="myArray01" rows=10 cols=120>0,Megan_Fox,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRezKBWzw2Svr0-iHLi4ZHmxMqJWxAFcNLzzaf_0uomkDRBH2n5***
1,Mila_Kunis,https://m.media-amazon.com/images/M/MV5BODQyNTQyNzY4MV5BMl5BanBnXkFtZTcwODg5MDA3MQ@@._V1_UY209_CR17,0,140,209_AL_.jpg***
2,Amanda_Seyfried,https://m.media-amazon.com/images/M/MV5BMjUyODkwODUyMF5BMl5BanBnXkFtZTcwMzU3MjYxMw@@._V1_UY209_CR22,0,140,209_AL_.jpg***
3,Hayden_Panettiere,https://m.media-amazon.com/images/M/MV5BOTY2OTI1NzA0NV5BMl5BanBnXkFtZTcwOTczMTA2Mw@@._V1_UY209_CR9,0,140,209_AL_.jpg***
4,Missy_Peregrym,https://m.media-amazon.com/images/M/MV5BMTQyNzExNzQ1N15BMl5BanBnXkFtZTcwNjk0NDAyMw@@._V1_UY209_CR12,0,140,209_AL_.jpg***
5,Rachel_McAdams,https://m.media-amazon.com/images/M/MV5BMTY5ODcxMDU4NV5BMl5BanBnXkFtZTcwMjAzNjQyNQ@@._V1_UY209_CR2,0,140,209_AL_.jpg***
6,Zoya_Afroz,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS--vsSruSvzEz1KqqOFOl5R6iEmWbisQpf3EmmfzWSNE9PPjMf***
7,Natalie_Portman,https://m.media-amazon.com/images/M/MV5BMTQ3ODE3Mjg1NV5BMl5BanBnXkFtZTcwNzA4ODcxNA@@._V1_UY209_CR8,0,140,209_AL_.jpg***
8,Lyrica_Okano,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRuPskWaL7GWlZttj8NVhJea9lcDw-Ux18o6lUCR5_8MqHkbfW3***
9,Jennifer_Connelly,https://m.media-amazon.com/images/M/MV5BOTczNTgzODYyMF5BMl5BanBnXkFtZTcwNjk4ODk4Mw@@._V1_UY209_CR8,0,140,209_AL_.jpg***
10,Malin_Akerman,https://m.media-amazon.com/images/M/MV5BMjA4ODAwMjIwOV5BMl5BanBnXkFtZTcwMzI2NDA2OA@@._V1_UY209_CR34,0,140,209_AL_.jpg***
11,Priyanka_Chopra,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR4J7rk9z9JN6jykDu-2e5ENOKVIrGQ1mhjVawlGbqcogseA92z***
12,Lyndsy_Fonseca,https://m.media-amazon.com/images/M/MV5BMTM2NTU2NDI5NF5BMl5BanBnXkFtZTcwMjgzMjA2MQ@@._V1_UY209_CR8,0,140,209_AL_.jpg***
13,Scarlett_Johansson,https://m.media-amazon.com/images/M/MV5BMTM3OTUwMDYwNl5BMl5BanBnXkFtZTcwNTUyNzc3Nw@@._V1_UY209_CR16,0,140,209_AL_.jpg***
14,Tamanna_Bhatia,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQYxvmY7DKrRhkGrOOiZ4x1J55Pk_BBxacNjnzT6Uw1cs-65maC***
15,Lana_Parrilla,https://m.media-amazon.com/images/M/MV5BMjM2MTE2MzA2Nl5BMl5BanBnXkFtZTgwNzU5OTIxMzE@._V1_UY317_CR104,0,214,317_AL_.jpg***
16,Emma_Stone,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTgcUOjQ7iMWKoZKFpCK-9sWePgYP0nxTJgQXQVa4wfQVCpi55X***
17,Jessica_Alba,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTnNlkueD_ajY-edEy_blKXd3Zf8iI82pe3qKqBFNTvQp0kIAeQ***
18,Bethany_Joy_Lenz,https://m.media-amazon.com/images/M/MV5BNGYxNzAwNTktMTEzZC00YzUzLThmNDEtZWQyYTM1NDZkMjkwXkEyXkFqcGdeQXVyMjEwOTk2NzQ@._V1_UX140_CR0,0,140,209_AL_.jpg***
19,Ellen_Page,https://m.media-amazon.com/images/M/MV5BMTU3MzM3MDYzMV5BMl5BanBnXkFtZTcwNzk1Mzc3NA@@._V1_UX140_CR0,0,140,209_AL_.jpg***
20,Kate_Beckinsale,https://m.media-amazon.com/images/M/MV5BMTM3MzY2MDYwOF5BMl5BanBnXkFtZTcwODQ3MDA0Nw@@._V1_UX140_CR0,0,140,209_AL_.jpg***
21,Diane_Kruger,https://m.media-amazon.com/images/M/MV5BMTM3MzY0Nzk2Ml5BMl5BanBnXkFtZTcwODQ0MTMyMw@@._V1_UY209_CR1,0,140,209_AL_.jpg***
22,Rihanna,https://m.media-amazon.com/images/M/MV5BMjExNTI5ODg2NF5BMl5BanBnXkFtZTcwNDQ3MDA0Nw@@._V1_UY209_CR3,0,140,209_AL_.jpg***
23,Rachel_Bilson,https://m.media-amazon.com/images/M/MV5BMTM2NjUxNzgxMV5BMl5BanBnXkFtZTcwNTc1Mjc1MQ@@._V1_UX140_CR0,0,140,209_AL_.jpg***
24,Drew_Barrymore,https://m.media-amazon.com/images/M/MV5BMjEyOTMzODIxM15BMl5BanBnXkFtZTcwODM2NTY5Mg@@._V1_UY209_CR4,0,140,209_AL_.jpg***
25,Taylor_Swift,https://m.media-amazon.com/images/M/MV5BMjA5ODI0NzIzNV5BMl5BanBnXkFtZTcwMzM0NjI2Nw@@._V1_UX140_CR0,0,140,209_AL_.jpg***
26,Alison_Lohman,https://m.media-amazon.com/images/M/MV5BMTM3NTIzMTk2Nl5BMl5BanBnXkFtZTYwNzEwOTI4._V1_UY209_CR2,0,140,209_AL_.jpg***
27,Angelina_Jolie,https://m.media-amazon.com/images/M/MV5BODg3MzYwMjE4N15BMl5BanBnXkFtZTcwMjU5NzAzNw@@._V1_UY209_CR15,0,140,209_AL_.jpg***
28,Nadine_Njeim,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQe92c2Ke6LLhgXi8DgqqYkWek2lWp6-qmZuuv1jwvYoHy1Ws7L***
29,Ashley_Greene,https://m.media-amazon.com/images/M/MV5BNDQwMjMyMDMyNF5BMl5BanBnXkFtZTcwNjI1MDQ5Nw@@._V1_UX140_CR0,0,140,209_AL_.jpg***
30,Jessica_Stroup,https://m.media-amazon.com/images/M/MV5BMTNkN2IzMzItNzJhYy00MWJjLWEzZWMtNTliODRiN2RiMTllXkEyXkFqcGdeQXVyNTExMjk4NA@@._V1_UX140_CR0,0,140,209_AL_.jpg***
31,Selena_Gomez,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSzX54VDX7cJJkGZYqyo_j8OgHzOoPLKrb8egAe7CfXRPXFGlA9***
32,Leighton_Meester,https://m.media-amazon.com/images/M/MV5BMjQ3ODQzMzQ3OV5BMl5BanBnXkFtZTgwNTg3MjI5NDE@._V1_UY209_CR8,0,140,209_AL_.jpg***
33,Kylie_Jenner,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT6oG92zj7zjq1K5oigZSAcAai2GA24djvw6XyXEckK0QsjU6kCpQ***
34,Nikki_Reed,https://m.media-amazon.com/images/M/MV5BMTM5NzQ2NjQwM15BMl5BanBnXkFtZTcwNzcwNzE2OQ@@._V1_UY209_CR1,0,140,209_AL_.jpg***
35,Beyonce,https://m.media-amazon.com/images/M/MV5BMjMxMzg3MDI5NV5BMl5BanBnXkFtZTcwOTAxODc0Ng@@._V1_UY209_CR21,0,140,209_AL_.jpg***
36,Emma_Watson,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTQfKfFrONouGkk-oJzokhfthHbwGokBswHpp5wsEaFMiYFe4nV8A***
37,Eva_Green,https://m.media-amazon.com/images/M/MV5BMTQ0MDA2ODE2Ml5BMl5BanBnXkFtZTcwMjI0Nzc3Nw@@._V1_UX140_CR0,0,140,209_AL_.jpg***
38,Cobie_Smulders,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSl0rxew1OiEYSeixuAOI7YS4zz_3kMlYoT14PK3CbFbpAzKtnd***
39,Zooey_Deschanel,https://m.media-amazon.com/images/M/MV5BMTgzMjM2NDE1OF5BMl5BanBnXkFtZTcwMjA2NDU5OA@@._V1_UY209_CR8,0,140,209_AL_.jpg***
40,Emily_Blunt,https://m.media-amazon.com/images/M/MV5BMTUxNDY4MTMzM15BMl5BanBnXkFtZTcwMjg5NzM2Ng@@._V1_UX140_CR0,0,140,209_AL_.jpg***
41,Kathryn_Prescott,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ6zyYd_qnJmNHNaEbS1u1y9cFw6I4oE_DWqPBOk-eX-EgJBPTR***
42,Katherine_Heigl,https://m.media-amazon.com/images/M/MV5BNTM0NDEwMjA1MV5BMl5BanBnXkFtZTcwMzQxMDI3Mg@@._V1_UY209_CR1,0,140,209_AL_.jpg***
43,Ashley_Benson,https://m.media-amazon.com/images/M/MV5BMTkzMDY1NDk5MV5BMl5BanBnXkFtZTgwNTMxNzIyOTE@._V1_UY209_CR34,0,140,209_AL_.jpg***
44,Hilarie_Burton,https://m.media-amazon.com/images/M/MV5BMTIxNDQzOTA0NF5BMl5BanBnXkFtZTYwMzQwNDIz._V1_UY209_CR1,0,140,209_AL_.jpg***
45,Alexis_Bledel,https://m.media-amazon.com/images/M/MV5BMTc4NTg4ODU0Ml5BMl5BanBnXkFtZTgwOTA1MjUwNDE@._V1_UY209_CR8,0,140,209_AL_.jpg***
46,Rosario_Dawson,https://m.media-amazon.com/images/M/MV5BMTk1NjQ3NTYyNF5BMl5BanBnXkFtZTcwODU4NzQ4NQ@@._V1_UX140_CR0,0,140,209_AL_.jpg***
47,Kate_Walsh,https://m.media-amazon.com/images/M/MV5BMTk2NDEzNzg3MV5BMl5BanBnXkFtZTcwNjI1Mzg2Mw@@._V1_UX140_CR0,0,140,209_AL_.jpg***
48,Claire_Danes,https://m.media-amazon.com/images/M/MV5BMTMyMzQ1Mjk3M15BMl5BanBnXkFtZTcwNzk3ODMxNw@@._V1_UY209_CR10,0,140,209_AL_.jpg***
49,Sienna_Miller,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSetnCAq3xYdbWq5MSAX5BQm3EUSXXDrdSRY-YeoexuVCOtFVkdZQ***
50,Shannyn_Sossamon,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSvKaBv7N4TaO6cT0yfmwrHqrWOPZafvNvwmOiklCna4KTv8EAM***
51,Fan_Bingbing,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTbF1dyaYAIy_rUjjaAbWRNHuK3So_ZQArFn09VMrS8pSGAhmYHXA***52,Piper_Perabo,https://m.media-amazon.com/images/M/MV5BMGEwY2E4MzEtNjVhNy00ZTUyLWE4YmUtODIxNzU2NGRmNDUzXkEyXkFqcGdeQXVyMTMxNTAxODk@._V1_UY209_CR34,0,140,209_AL_.jpg***
53,Halla_Vilhjalmsdottir,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTl3fuXP0qR0gwLBwNHhO67PSaTZra71l87fHkeLBAqXSNupBqZ***
54,Jordana_Brewster,https://m.media-amazon.com/images/M/MV5BMTc1OTMwMzM3NF5BMl5BanBnXkFtZTgwMTM5MzIyODE@._V1_UX140_CR0,0,140,209_AL_.jpg***
55,Samaire_Armstrong,https://m.media-amazon.com/images/M/MV5BMTY5NTYyMjAzNV5BMl5BanBnXkFtZTcwNTg2NjA2NQ@@._V1_UY209_CR5,0,140,209_AL_.jpg***
56,Carey_Mulligan,https://m.media-amazon.com/images/M/MV5BMTUzODM0OTY4OF5BMl5BanBnXkFtZTgwMTg3NDk0NzE@._V1_UX140_CR0,0,140,209_AL_.jpg***
57,Kate_Hudson,https://m.media-amazon.com/images/M/MV5BMTA1NTk0MjMyOTFeQTJeQWpwZ15BbWU3MDA4NzEzMTM@._V1_UY209_CR8,0,140,209_AL_.jpg***
58,Fahriye_Evcen,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSrEEmLvgVR4Q47QqjvoT2KpP3XnsfR4oPjit_sDYL3HwLxqjKQ***
59,Gemma_Arterton,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRnnEBVFcKU-m7sQpNI9XIoX87yeBwhdJH_z_op3aNT-c4nuYgt***
60,Jennifer_Lopez,https://m.media-amazon.com/images/M/MV5BMTY0OTY3ODA3OV5BMl5BanBnXkFtZTcwMzMyMzQ1NQ@@._V1_UY209_CR21,0,140,209_AL_.jpg***
61,Naya_Rivera,https://m.media-amazon.com/images/M/MV5BOTk0MzMzODQ2OV5BMl5BanBnXkFtZTcwMTAyMzY3Mg@@._V1_UY209_CR17,0,140,209_AL_.jpg***
62,Emma_Roberts,https://m.media-amazon.com/images/M/MV5BZjRlMTA0YmYtZTE1ZS00NDk3LWI0MjQtNmEyMzllNDVmODM0XkEyXkFqcGdeQXVyMTIxMTA0Ng@@._V1_UY209_CR14,0,140,209_AL_.jpg***
63,Ariana_Grande,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQoU5_2Cw9VdjP8m0vhZORly0J_YThsAEkTgTM0o37v8_Pvhwxj***
64,Kate_Upton,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSHIVBZOaGGpLXwr_kaUBBOtCcQBuO1aYBkdHQFdylfj5N8OSQcFw***
65,Elle_Fanning,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdk1TnrL28ZrV6f23aPy6U3rPe6Yf3JUt4NIKmUg0JfwLIXbQySg***
66,Reese_Witherspoon,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT0gLGkD0DXrWFkJHFUOE51WEgE-250SdHQuobCtpZU_Ysd8qB3***
67,Brittany_Snow,https://m.media-amazon.com/images/M/MV5BZDg4ZjI3YTgtYTZkZS00Nzg2LTk1Y2QtZjMyNmRjZDA2MTg2XkEyXkFqcGdeQXVyMjQ5MTkzMjc@._V1_UY209_CR3,0,140,209_AL_.jpg***
68,Nina_Dobrev,https://m.media-amazon.com/images/M/MV5BMmFkMGIxYTItNWI0My00NmJkLWFmYTItNWIxN2Y2ZmRhMWRlXkEyXkFqcGdeQXVyMTM5NDMzMjY@._V1_UX140_CR0,0,140,209_AL_.jpg***
69,Zoe_Saldana,https://m.media-amazon.com/images/M/MV5BMjA4NDk1NTA1OV5BMl5BanBnXkFtZTcwMTIzMjQ4Ng@@._V1_UY209_CR6,0,140,209_AL_.jpg***
70,Miranda_Kerr,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTyaAocDVwwDoZzn7mewkwPj2iy0C1Pg5Khz4k1-e-4g6zuf80VnQ***
71,Kelsey_Chow,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRlGJMbgRSv2M27X8ebCI_sBK6aszxQVxOC_89vUxnlxftrhlBSxA***
72,Monica_Bellucci,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQg91ycgstV30A7DiNNtaabNxgO-dWyXwMKOWgc8xtCIKUBqTS3***
73,Liza_Berggren,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTVm-ZG_rvMQIAC0zHBove4LDcZ2KPp_4fzqAXoCsWf_aBdI4QKGg***
74,Indiana_Evans,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQVkVXsV76c6WJmBJZfNvr3N-UIaBVoNulDPRkBP9M0Z-hs4Neo***
75,Amber_Heard,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTUOaWEBB-tr1GGIiIGLRZoD6g4Dz5h5_9aHhJVV2WKHJvE1dE3***
76,Sharon_Stone,https://m.media-amazon.com/images/M/MV5BMTg0MDU1ODQwNF5BMl5BanBnXkFtZTcwOTc3MjQwNA@@._V1_UY209_CR3,0,140,209_AL_.jpg***
77,Emina_Cunmulaj,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQCfb9aS7CMydjR1B6pUoB3Ungzpu80pENRDTQ9z6P5ia9PtCxH***
78,Alicia_Keys,https://m.media-amazon.com/images/M/MV5BMTcxOTU1NTA5MF5BMl5BanBnXkFtZTcwOTQ5MDkxNw@@._V1_UX140_CR0,0,140,209_AL_.jpg***
79,Claudia_Kim,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRh_OrEw5U1nSzQD6lvP0_70KWcXJlfuHk96xf1sN_-8c9ReOndrw***
80,Hailee_Steinfeld,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQMps1Gg7hanWEOXA3fPQs9r8N0lz8lY2RmsmByIYMQtbAedo5VIQ***
81,Emilie_de_Ravin,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTfgcP7NyFX5fzTlXs27MMWKev1PU8wyeIoUN6ONId2EmlxeONu2w***
82,Jennifer_Lawrence,https://m.media-amazon.com/images/M/MV5BOTU3NDE5MDQ4MV5BMl5BanBnXkFtZTgwMzE5ODQ3MDI@._V1_UX140_CR0,0,140,209_AL_.jpg***
83,Naomi_Watts,https://m.media-amazon.com/images/M/MV5BMjIzMjY1NTA4OF5BMl5BanBnXkFtZTcwNjk3MDYwOQ@@._V1_UX140_CR0,0,140,209_AL_.jpg***
84,Ornella_Muti,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRYxMWQbZLaB99hdLdFRA2FbQBvAocogTlRmQVtqHfEQJiPcB14***
85,Nelly_Furtado,https://m.media-amazon.com/images/M/MV5BMTQ5OTMxMTMyOF5BMl5BanBnXkFtZTcwMzExMjQ4Mg@@._V1_UX140_CR0,0,140,209_AL_.jpg***
86,Charlize_Theron,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ0jWmsZ3D-MsnFTEwMZL_wvnCwLFZz7pvj3p4s2V-X1zNqrnTV***
87,Dajana_Kllogjri,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSlBVewTAjLJ9ztdcBQzXlpOoNXy8VqiQ-i-1M1DLxHo-rLo_Yw8Q***
88,Emily_Browning,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTgZfGhCh0McF3KRU5VhGxy9w1ir4D0BGeA9sW2ovYiabkskwsG***
89,Kirsten_Dunst,https://m.media-amazon.com/images/M/MV5BMTQ3NzkwNzM1MV5BMl5BanBnXkFtZTgwMzE2MTQ3MjE@._V1_UY209_CR8,0,140,209_AL_.jpg***
90,Anne_Hathaway,https://m.media-amazon.com/images/M/MV5BNjQ5MTAxMDc5OF5BMl5BanBnXkFtZTcwOTI0OTE4OA@@._V1_UY209_CR1,0,140,209_AL_.jpg***
91,Paulina_Porizkova,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSTLTAN7aJnz9-DG8D_bnZpKtSZpLrHR7AmY9a5fYqa3vPqKJrA***
92,Cameron_Diaz,https://m.media-amazon.com/images/M/MV5BMTkxNTI5NzM4MV5BMl5BanBnXkFtZTcwMTI3ODY3Mg@@._V1_UY209_CR1,0,140,209_AL_.jpg***
93,Kate_Bosworth,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTMVGkv2j-dtjzGl0orEBx3Hds53ZJx18-riu5BmCtJPFfmVfHX***
94,Monica_Hansen,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS0QzB0R_RuNWLMOuREK4udx2vYrtkH7tR6PusuRGdsVGYkHBZ1***
95,Penelope_Cruz,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRvb4ksoOTCM2-BRNAtkcvf2DrGWgtLzfF30pQqHEgQw_j9eBmB***
96,Michelle_Pfeiffer,https://m.media-amazon.com/images/M/MV5BMTUzNjI0Njc5NF5BMl5BanBnXkFtZTYwOTM2MjYz._V1_UX140_CR0,0,140,209_AL_.jpg***
97,Alexandra_Daddario,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS0hf53QzX9niW4Ev6grnA2ZLsO7Af_wxZQCM-s_cUG7VCgEKS7***
98,Halle_Berry,https://m.media-amazon.com/images/M/MV5BMjIxNzc5MDAzOV5BMl5BanBnXkFtZTcwMDUxMjMxMw@@._V1_UY209_CR7,0,140,209_AL_.jpg***
99,Angela_Martini,https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ9u9_rFPBmpnCuU1DPM_j46zb2IltwDw5wjeYcxOSoDSbK0q50qg</textarea> 
 
 <!-- ************* Next we define the Javascript inside a web element so that the page can be refreshed dynamically **************-->
 
 <!--  ************* The entire next line can be replaced with the <script> tag for a more conventional approch. ****************** -->

<style id="myButton124"  onload="{document.getElementById('myButton124').click()}"  onclick="{

 ///////////////////////////////////// Global Variables ////////////////////////////////                                                                                            
                                                                                            
//position:relative; left:-650px;
let myGroups = []
let newArray = []  
let newArray2 = []  
let myFaceToClose = 0    // pixels to make bounding box bigger
let myIncomingClassifier = []    
let myIncomingImages = []                                                                                             

 ///////////////////////////////////// Canvas and video elements ////////////////////////////////                                                                                                   
                                                                                             
                                                                                             

//////////////////////////////////////// knn classifier stuff///////////////////////////

                                                                                             
myCheckGroups   = async function() {  
   document.getElementById('myDivLoss').innerHTML = ''  // clear it                                                                                          
   for (let x=0;   x < myGroups.length; x++){
                                                                                             
      if (myGroups[x] == undefined) {
            document.getElementById('myDivLoss').innerHTML += '<font color=red>#: '+ x + ', label: </font><br>'                                                                                 
          } else {                                                                                       
         document.getElementById('myDivLoss').innerHTML += '#: '+ x + ', label: '+ myGroups[x] + '<br>' 
      }                                                                                       
   } 
 }                                                                                            
                                                                                             
                                                    
myShowInfo = async function() {
                                                                                             
     myIn = document.getElementById('myArray01').value.split('***')    // made it global
   document.getElementById('myDivLoss').innerHTML = '' // clear it  
                                                                                             
   for (myIteration = 0;  myIteration < myIn.length; myIteration++){   
                                                                                                   
      myIncomingImages[myIteration] = []    // make new part of 2D array                                                                         
      myIncomingImages[myIteration] = myIn[myIteration].split(',')    // [0] = groups,   [1] = labels,    [2] = Image URL                                                                                       
      document.getElementById('myDiv123').innerHTML +=  `<a href='https://www.google.com/search?&tbm=isch&q=`+myIncomingImages[myIteration][1]+`' target='_blank'>`+myIteration+`: `+myIncomingImages[myIteration][1]+ `</a>,   `                                                                                   
      document.getElementById('myDiv123').innerHTML += `<a href='${myIncomingImages[myIteration][2]}'>Image Only</a><br>`
                                                                                             
    }                                                                                       
}
myShowInfo2 = async function() {
                                                                                             
     myIn = document.getElementById('myArray01').value.split('***')    // made it global
   document.getElementById('myDivLoss').innerHTML = '' // clear it  
                                                                                             
   for (myIteration = 0;  myIteration < myIn.length; myIteration++){   
                                                                                                   
      myIncomingImages[myIteration] = []    // make new part of 2D array                                                                         
      myIncomingImages[myIteration] = myIn[myIteration].split(',')    // [0] = groups,   [1] = labels,    [2] = Image URL                                                                                       
      document.getElementById('myDiv123').innerHTML +=  `<a href='https://www.google.com/search?&tbm=isch&q=`+myIncomingImages[myIteration][1]+`' target='_blank'>`+myIteration+`: `+myIncomingImages[myIteration][1]+ `</a>,   `                                                                                   
      document.getElementById('myDiv123').innerHTML += `<a href='${myIncomingImages[myIteration][2]}'>Image Only</a><br>`
                                                                                         
    } 
                                                                                             
                                                                                               
   for (myIteration2 = 0;  myIteration2 < myIn.length; myIteration2++){                                                                                                
     ( function(myIteration2) {  
         console.log(myIteration2)                                                                                     
         window.open(myIncomingImages[myIteration2][2], '_blank');                                                                                                                                                                           
     }  )(myIteration2)                                                                                               
  }
                                                                                             
}                                                                                                
                                                                                             
                                                                                             
myLoadManyImages = async function() {
  document.getElementById('myDiv01').innerHTML =''
   const myIn = document.getElementById('myArray01').value.split('***')
   document.getElementById('myDivLoss').innerHTML = '' // clear it  
                                                                                             
   for (myIteration = 0;  myIteration < myIn.length; myIteration++){ 
      myIncomingImages[myIteration] = []    // make new part of 2D array                                                                         
      myIncomingImages[myIteration] = myIn[myIteration].split(',')    // [0] = groups,   [1] = labels,    [2] = Image URL
      let myI = parseInt(myIncomingImages[myIteration][0])
                                                                                         
      let myFileName2 =  myIncomingImages[myIteration][2]    // the URL                                                                                   
      if (myFileName2 != null) {
        let img = new Image()
        img.src = myFileName2
        img.crossOrigin = 'Anonymous'                                                                                            
                                                                                                                                                                                    
        let can = document.getElementById('my32x32CanvasA');
        let ctx = can.getContext('2d');  
        ctx.clearRect( 0, 0, can.width, can.height)                                                                                     
     //const getIngredients = async () => {}                                                                                        
        tf.nextFrame()                                                                                     
        img.onload = await async function() {
            ctx.drawImage(img, 0, 0, img.width, img.height, 0, 0, can.width, can.height);                                         
        }  // img  
        tf.nextFrame()                                                                                     
       const img2 = await tf.fromPixels(my32x32CanvasA);          // now lets classify the image                                                                                    
       const myDetectMarks = await net.detectLandmarks(img2)                                                                                                                                                                                        
       tf.nextFrame()
       for (let j=0;  j < myDetectMarks._faceLandmarks.length; j++ ){  
         newArray[j] = []                                                                                        
         newArray[j][0] = myDetectMarks._faceLandmarks[j].x                                                                
         newArray[j][1] = myDetectMarks._faceLandmarks[j].y  
       }                                                                                          
       tf.nextFrame()
       document.getElementById('myDivLoss').innerHTML += 'Checking ' + myI + '<br>'                                                                                  
                                                                                   
       const forwardParams = {inputSize: 'sm', scoreThreshold:0.5}   // 'xs' (224 x 224) | 'sm' (320 x 320) | 'md' (416 x 416) | 'lg' (608 x 608)  //0, 1, 2, 3
       result2 = await faceapi.tinyYolov2(can, forwardParams) 
       console.log(myI)  
       console.log(result2)  
       if (result2.length > 0){     
                                                                                             
          myGroups[myI] =  myIncomingImages[myIteration][1]       // add the label to the myGroups array                                                             
        /*                                                                                 
          classifier.addExample(tf.tensor2d(newArray, shape=[68,2]), myI);                                                                                                                                                                                                                                              
          const myAddCount = classifier.getClassExampleCount()[myI]      
                                                                                             
          document.getElementById('myDivLoss').innerHTML += myAddCount + ' times, Example Added: to group #: '+ myI +'<br>'     
          document.getElementById('myDiv01').innerHTML += myI+': '+ Math.round(newArray[0][0])+', '+ Math.round(newArray[0][1])+'<br>'                                                                                         
        */                                                                                     
                                                                                             
       /////////////////////////////// prove we got a face ///////////////////////////////
 
                                                                                             
      let { width, height } = faceapi.getMediaDimensions(can)
      let canvas = document.getElementById('myBorderAsCanvas')
      canvas.width = width
      canvas.height = height
      const forwardParams = {inputSize: 'sm', scoreThreshold: 0.5}
      result2 = await faceapi.tinyYolov2(can, forwardParams)                                                                                        
                                                                                        
      faceapi.drawDetection('myBorderAsCanvas', result2.map(det => det.forSize(width, height)))   
      tf.nextFrame()                                                                                       
                                                                                             
     let myCanvasElement4 = document.getElementById('myVideoAsCanvas');
     let myCTX4 = myCanvasElement4.getContext('2d');
     myCTX4.drawImage(can, 0, 0, myCanvasElement4.width, myCanvasElement4.height);
      tf.nextFrame()                                
     let myCanvasElement3 = document.getElementById('myFaceCanvas');
     let myCTX3 = myCanvasElement3.getContext('2d');
                                                                                             
     myCTX3.drawImage(myCanvasElement4, result2[0]._box._x-myFaceToClose, result2[0]._box._y-myFaceToClose, result2[0]._box._width+(2*myFaceToClose), result2[0]._box._height+(2*myFaceToClose), 0, 0, myCanvasElement3.width, myCanvasElement3.height);
     tf.nextFrame()                                                                                    
     let img3 = tf.fromPixels(myFaceCanvas);    // the bounded canvas                                                                                                                    
     const myLandmarks = await net.detectLandmarks(img3)                                                                                                                                                                                      
  
     for (let j=0;  j < myLandmarks._faceLandmarks.length; j++ ){  
       newArray2[j] = []                                                                                        
       newArray2[j][0] = myLandmarks._faceLandmarks[j].x                                                                
       newArray2[j][1] = myLandmarks._faceLandmarks[j].y  
     }                                                                                          
     tf.nextFrame()                                                                                               
    // myCTX3.drawImage(can, 0, 0, myCanvasElement3.width, myCanvasElement3.height);                                                                                                                                                                                            
   //  const result = await classifier.predictClass(tf.tensor2d(newArray2, shape=[68,2]), 3);   // number of groups
                                                                                              
    const wow = await faceapi.drawLandmarks(myCanvasElement3, myLandmarks, { lineWidth: 2, color: 'red' })    // may remove these eventually                                                                                                                                                                             
    tf.nextFrame()                                                                                     
    
          classifier.addExample(tf.tensor2d(newArray2, shape=[68,2]), myI);                                                                                                                                                                                                                                              
          const myAddCount = classifier.getClassExampleCount()[myI]      
                                                                                             
          document.getElementById('myDivLoss').innerHTML += myAddCount + ' times, Example Added: to group #: '+ myI +'<br>'     
          document.getElementById('myDiv01').innerHTML += myI+', '+myIncomingImages[myIteration][1]+': '+ Math.round(newArray2[0][0])+', '+ Math.round(newArray2[0][1])+'<br>'                                                                                         
          tf.nextFrame() 
          alert(myI+', '+myIncomingImages[myIteration][1])                                                                                        
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
   // document.getElementById('myDiv01').innerHTML += myI+', double check: '+ Math.round(myLandmarks._faceLandmarks[0].x)+', '+ Math.round(myLandmarks._faceLandmarks[0].y)+'<br>'                                                                                         
    tf.nextFrame()                                                                                            
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
        ///////////////////////////////// end proof ///////////////////////////////////                                                                                     
                                                                                             
                                                                                             
       }                                                                                      
                                                                                             
     }     // if                                                                                                                                                                                            
   }       // for                                                                        
  // console.log(myIncomingImages)                                                  
  // console.log(myGroups)                                                                                        
                                                                                             
}
                                                                                             

myRunFace = async function() {
                                                                                        
   classifier = knnClassifier.create();                                     
   console.log('knn-classigfier loaded')
                                                                                             
   net = new faceapi.FaceLandmark68TinyNet()       // made it global                                                                                      
   await net.load('https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/advanced-keras/face/models/face_landmark_68_tiny_model-weights_manifest.json')                                                                                                                                 
   console.log('face_landmark_68_tiny_model loaded')
                                                                                             
   await faceapi.loadTinyYolov2Model('https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/advanced-keras/face/muehler/models')
   console.log('loadTinyYolov2Model loaded')
                                                                                          
}


myTextChange = async function(){     
    if (parseInt(document.getElementById('myClassNumber').value) < 0 ){
           document.getElementById('myClassNumber').value = 0                                                                                  
    }                         
    if (myGroups[document.getElementById('myClassNumber').value] == undefined){
        document.getElementById('myClassText').value    = ''   // clear the box                                                                                     
      } else {                                                                                         
        document.getElementById('myClassText').value    = myGroups[document.getElementById('myClassNumber').value] 
    }
}                                                                                             

myNewTrain = async function(){   

   let myCanvasElement = document.getElementById('my32x32CanvasA');
   let myCTX = myCanvasElement.getContext('2d');
   myCTX.drawImage(myVideoStream, 0, 0, myCanvasElement.width, myCanvasElement.height);   
                                     
   const img1 = tf.fromPixels(my32x32CanvasA);                                                                                            
   const myDetectMarks = await net.detectLandmarks(img1)                                                                                                                                                                                        

   for (let j=0;  j < myDetectMarks._faceLandmarks.length; j++ ){  
      newArray[j] = []                                                                                        
      newArray[j][0] = myDetectMarks._faceLandmarks[j].x                                                                
      newArray[j][1] = myDetectMarks._faceLandmarks[j].y  
   }                                                                                          
                                                                                               
   classifier.addExample(tf.tensor2d(newArray, shape=[68,2]), parseInt(document.getElementById('myClassNumber').value));                                                              
   myGroups[document.getElementById('myClassNumber').value] = document.getElementById('myClassText').value
 
   const myAddCount = classifier.getClassExampleCount()[document.getElementById('myClassNumber').value]
   const myGroupNumber =  document.getElementById('myClassNumber').value                                                                                         
   document.getElementById('myDivLoss').innerHTML = myAddCount + ' times, Example Added: to group #: '+ myGroupNumber 
                                                                                     
                                                                                             
                                                                                                                                                                                   
                                                                                             
                                                                                             
                                                                                             
}
                                                                                             
                                                                                             
 
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
myPredict = async function(){
  let scoreThreshold = 0.5   //0.5
  let sizeType = 'sm'      // 'xs' (224 x 224) | 'sm' (320 x 320) | 'md' (416 x 416) | 'lg' (608 x 608)  //0, 1, 2, 3
  let modelLoaded = false
  let forwardTimes = []
                                                                                             
  let myCanvasElement = document.getElementById('my32x32CanvasA');
  let myCTX = myCanvasElement.getContext('2d');                                                                                             
  myCTX.drawImage(myVideoStream, 0, 0, myCanvasElement.width, myCanvasElement.height);  
                                                                                            
  if (classifier.getNumClasses() >= 1){    // have groups to rate
                                            
      let { width, height } = faceapi.getMediaDimensions(myCanvasElement)
      let canvas = document.getElementById('myBorderAsCanvas')
      canvas.width = width
      canvas.height = height
      const forwardParams = {inputSize: sizeType, scoreThreshold}
      result2 = await faceapi.tinyYolov2(myCanvasElement, forwardParams)                                                                                        

    if (result2.length >= 1){     // box drawing working   
                                                                                             
      
      faceapi.drawDetection('myBorderAsCanvas', result2.map(det => det.forSize(width, height)))   
                                                                                             
                                                                                             
     let myCanvasElement4 = document.getElementById('myVideoAsCanvas');
     let myCTX4 = myCanvasElement4.getContext('2d');
     myCTX4.drawImage(myVideoStream, 0, 0, myCanvasElement4.width, myCanvasElement4.height);
                                      
     let myCanvasElement3 = document.getElementById('myFaceCanvas');
     let myCTX3 = myCanvasElement3.getContext('2d');
                                                                                             
     myCTX3.drawImage(myCanvasElement4, result2[0]._box._x-myFaceToClose, result2[0]._box._y-myFaceToClose, result2[0]._box._width+(2*myFaceToClose), result2[0]._box._height+(2*myFaceToClose), 0, 0, myCanvasElement3.width, myCanvasElement3.height);
                                                                                         
     let img3 = tf.fromPixels(myFaceCanvas);    // the bounded canvas                                                                                                                    
     const myLandmarks = await net.detectLandmarks(img3)                                                                                                                                                                                      
  
     for (let j=0;  j < myLandmarks._faceLandmarks.length; j++ ){  
       newArray2[j] = []                                                                                        
       newArray2[j][0] = myLandmarks._faceLandmarks[j].x                                                                
       newArray2[j][1] = myLandmarks._faceLandmarks[j].y  
     }                                                                                          
                                                                                                    
     myCTX.drawImage(myVideoStream, 0, 0, myCanvasElement.width, myCanvasElement.height);                                                                                                                                                                                            
     const result = await classifier.predictClass(tf.tensor2d(newArray2, shape=[68,2]), 3);   // number of groups
                                                                                              
    faceapi.drawLandmarks(myCanvasElement3, myLandmarks, { lineWidth: 2, color: 'red' })    // may remove these eventually                                                                                                                                                                             
   
                                                                                             
                                                                                             
                                                                                             
                                                                                             
    document.getElementById('myDivTest').innerHTML = 'Group: ' + result.classIndex + ', '+ 
       Math.round(result.confidences[result.classIndex]*100)+ '% ' + myGroups[result.classIndex]+ '<br>' 
  } // end box drawing OK                                                                                             
 } else {(console.log('Need to train groups'))}
                                                                                             
}
                                                                                             
    
                                                                                             
                                                                                             
  
/////////////////////////////////////////// NEW SAVING and LOADING functions ///////////////////////////////////////////                                                                                      
                                                                                             
                                                                                             
 myDefineClassifierModel = async function(myPassedClassifier){

    let myLayerList = []
     myLayerList[0] = []    // for the input layer name as a string
     myLayerList[1] = []    // for the input layer
     myLayerList[2] = []    // for the concatenate layer name as a string
     myLayerList[3] = []    // for the concatenate layer
                                                                                                                                                                                        
    let myMaxClasses =    myPassedClassifier.getNumClasses()                                                                                      
    //console.log('myPassedClassifier.getNumClasses()')
    //console.log(myMaxClasses)                                                                                      
                                                                                             
    for (let myClassifierLoop = 0; myClassifierLoop < myMaxClasses; myClassifierLoop++ ){      // need number of classifiers                                        
                                                                                         
      //console.log(myPassedClassifier.getClassifierDataset()[myClassifierLoop])                                                                                                                                                           
      //console.log('shape first layer =')                                                                                                                                                           
      //console.log(myPassedClassifier.getClassifierDataset()[myClassifierLoop].shape[0])
                                                                                             
      myLayerList[0][myClassifierLoop] = 'myInput'  + myClassifierLoop                  // input name as a string
      console.log('define input for'+myClassifierLoop)                                                                                       
      myLayerList[1][myClassifierLoop] = tf.input({shape: myPassedClassifier.getClassifierDataset()[myClassifierLoop].shape[0], name: myLayerList[1][myClassifierLoop]});      // Define input layer
      console.log('define dense for: '+myClassifierLoop)
      myLayerList[2][myClassifierLoop] = 'myInput'+myClassifierLoop+'Dense1'    // concatenate as a string                                                                                  
      myLayerList[3][myClassifierLoop] = tf.layers.dense({units: 136, name: myGroups[myClassifierLoop]}).apply(myLayerList[1][myClassifierLoop]);             //Define concatenate layer                                                                          
                                                                                           
    }
                                                                                             

   // what the layers used to look like before the loop                                                                                            
   //const myInput2 = tf.input({shape: [1], name: 'myInput2'});
   //const myInput2Dense1 = tf.layers.dense({units: 20, name: 'myInput2Dense1'}).apply(myInput2);

                                                                                             
   console.log('Concatenate Paths')                                                                                                                                                                                          
   const myConcatenate1 = tf.layers.concatenate({axis : 1, name: 'myConcatenate1'}).apply(myLayerList[3]);    // send the entire list of dense                                                                                           
   const myConcatenate1Dense4 = tf.layers.dense({units: 1, name: 'myConcatenate1Dense4'}).apply(myConcatenate1)                                                                                              
 
   console.log('Define Model')                                                                                                                                                                                       
   const myClassifierModel = tf.model({inputs: myLayerList[1], outputs: myConcatenate1Dense4});    // This would be a global model. With list of inputs as an array                                                                                                                                                                                         
   myClassifierModel.summary()
   console.log('myClassifierModel.layers[myMaxClasses]')     
   console.log(myClassifierModel.layers[myMaxClasses])
   myPassedClassifier.getClassifierDataset()[0].print(true)                                                                                            
                                                                                             
   for (let myClassifierLoop = 0; myClassifierLoop < myMaxClasses; myClassifierLoop++ ){   // since the first layers are inputs must add maxClasses   
     const myInWeight = await myPassedClassifier.getClassifierDataset()[myClassifierLoop]                                                                                        
     myClassifierModel.layers[myClassifierLoop + myMaxClasses].setWeights([myInWeight, tf.ones([136])]);       //model.layers[0].setWeights([tf.ones([10, 2]), tf.ones([2])]);                                                                                        

  }                                                                                           
                                                                                             
 return  myClassifierModel                                                                                        
}                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                                                                     
                                                                                             
                                                                                            
                                                                                             
///////////////////////////////////////////////////////////////////////////////                                                                                             
myClassifierSave  = async function(){
                                                                                                                                                                                        
   const myClassifierModel2 = await myDefineClassifierModel(classifier)         // pass global classifier                                                                                                                                                                                                                                                                      
   myClassifierModel2.save('downloads://myClassifierModel01')  
   myClassifierModel2.summary(null,null,x => {document.getElementById('myDivSummary').innerHTML += x + '<br>'});                                                                                                                                                                                                                                                                             
}
                                                                                             
 
                                                                                             
                                                                                             
/////////////////////////////////////////////                                                                                             
mySetClassiferModelWeights  = async function(){
                                                                                             
                                                                                             
}                                                                                              
  
                                                                                                
                                                                                             
//////////////////////////////////////////////////////////////////////////////
myClassifierLoad  = async function(){
   // note global variable called        myIncomingClassifier        
                                                                                             
   const myLoadedModel  = await	tf.loadModel(document.getElementById('myInFile').value)                                                                                          
   console.log('myLoadedModel.layers.length')   
   console.log(myLoadedModel.layers.length) 
                                           
                                           
  // console.log('myLoadedModel.layers[0].batchInputShape[1]')   
  // console.log(myLoadedModel.layers[0].batchInputShape[1] )       
                                                                                   
  const myMaxLayers = myLoadedModel.layers.length
  const myDenseEnd =  myMaxLayers - 2                                                                                          
  const myDenseStart = myDenseEnd/2         // assume 0 = first layer: if 6 layers 0-1 input, 2-3 dense, 4 concatenate, 5 dense output                                                                                  
                                                                                            
   for (let myWeightLoop = myDenseStart; myWeightLoop < myDenseEnd; myWeightLoop++ ){      // need number of classifiers                                        
                                              
      // console.log('myLoadedModel.layers['+myWeightLoop+']')   
      // console.log(myLoadedModel.layers[myWeightLoop])          
      console.log('myLoadedModel.layers['+myWeightLoop+'].getWeights()[0].print(true)') 
     // myLoadedModel.layers[myWeightLoop].getWeights()[0].print(true)                                                                                        
      myIncomingClassifier[myWeightLoop - myDenseStart] =  myLoadedModel.layers[myWeightLoop].getWeights()[0] 
      myGroups[myWeightLoop - myDenseStart] =  myLoadedModel.layers[myWeightLoop].name     // hopefully the name is the group name                                                                                     
   }
  console.log('Printing all the incoming classifiers')
  for (x=0;  x < myIncomingClassifier.length ; x++){
    myIncomingClassifier[x].print(true)                                                                                          
  }                                                                                           
  console.log('Activating Classifier')   
  
  classifier.dispose() // clear old classifier 
  classifier.setClassifierDataset(myIncomingClassifier)  
  console.log('Classifier loaded')                                                                                              
                                                                                             
}                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                                                                                                                         
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
            
///////////////////////////////////// End KNN- Classifier stuff ///////////////////////////////////// 
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
                                                                                             
///////////////////////////////////// webcam stuff /////////////////////////////////////                                                                                             
 
                                                                                             
var myVideoStream = document.getElementById('myVideoElement')     // make it a global variable
var myStoredInterval = 0

                                                                                             
                                                                                             
stopVideo = async function() {  
  clearInterval(myStoredInterval)   // god idea to stop the auto snapshot taking                                                                                         
  myVideoStream.srcObject.getTracks().forEach(track => track.stop())  
}
   
   
                                                                                             
                                                                                             
                                                                                             
getVideo = async function() {  
  const myCamera = await document.getElementById('myCheck').value
                                                                                     
  navigator.getMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
  navigator.getMedia({video: { facingMode: myCamera }, audio: false},
                     
    function(stream) {
      myVideoStream.srcObject = stream   
      myVideoStream.play();
  }, 
                     
   function(error) {
     alert('webcam not working');
  });
}
   
                                                                                             
                                                                                             


                                                                                             
takeAuto = async function(){                                                                                           
    myStoredInterval = setInterval(async function(){                                                                                         
       await myPredict()                                                                                   
   }, document.getElementById('myInterval').value);        
}
  
   
                                                                                             
                                                                                             
myStopAuto  = async function(){                                                                                             
    clearInterval(myStoredInterval)    
}                                                                                            
  
                                                                                             
                                                                                             
                                                                                             
 ///////////////////////////////////////////// Done Webcam functions ////////////////////////////////////////                                                                                               
                                                                                             
 myLoadUrl = async function(){
  //alert('The test function will need to be changed if other models are loaded')                                                                                             
  document.getElementById('myDivTest').innerHTML = 'Expect major code changes if you load a different model than what is expected'  
  const myFileName = document.getElementById('myInFile').value
  if (myFileName != null){  
    model = await tf.loadModel(myFileName);     // should make the model a global variable
    document.getElementById('myDivSummary').innerHTML = ''      
    await model.summary(null,null,x => {document.getElementById('myDivSummary').innerHTML += x + '<br>'});
   // await myPredict()
  }                                                                           
}                                                                                             
                                                                                             

                                                                                             
                                                                                  
                                                                                             
                                                                                             
/////////////////////////////////// END ALL FUNCTIONS ///////////////////////////////////////                                                                                             
                                                                                             
                                                                                             
                                                                                             
//////////////////////////////////   WEIRD STYLE TAG THAT IS ACTUALLY A DYNAMIC SCRIPT TAG ///////////////////                                                                                          
                                                                                             
                                                                                             
}"></style>
<!-- If you replaced the <style> tag with a <script> tag don't forget to change the above line to just </script>  -->
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
</div>
<div id='myDiv123'>...</div><br>

<input id="myUpdate123" type=button value="Update and Run" style="visibility:hidden;" onclick="{

   // first remove first and last line since they are injected
  myFred = document.getElementById('myTextarea123').value.split('\n')
  myFred.pop()
  myFred.push('')
  myFred.shift()
  myFred.shift()
  myJoe = myFred.join('\n')

  document.getElementById('myDiv123Code').innerHTML =    myJoe 
  document.getElementById('myButton123').click()
                                             
}"><br>

<textarea id="myTextarea123"  wrap="off"  style= "font-size:15px; color:white; background-color:black; width:90%;"   rows=2 onclick="{
  if (myOnce123){
     myTextGrow('myTextarea123', 'myDiv123Code')
     document.getElementById('myUpdate123').style.visibility = 'visible'
     myOnce123 = false
  }
}">
Click here to see the working HTML code.
</textarea><br>





















This <a href="https://github.com/hpssjellis/beginner-tensorflowjs-examples-in-javascript">Github</a>, ...  
this <a href="https://hpssjellis.github.io/beginner-tensorflowjs-examples-in-javascript/">Github Website Version</a>, ... 
this <a href="http://rocksetta.com/tensorflowjs/">Hosted Website Version</a>, ... 
<a href="https://js.tensorflow.org/">Tensorflowjs</a> <br> <br>



By Jeremy Ellis <br>
Twitter<a href="https://twitter.com/@rocksetta">@rocksetta</a><br>
Website <a href="http://rocksetta.com">http://rocksetta.com</a><br>
Use at your own risk!
    
    
    


 
 
 

<!--  Following is a helper functions  to grow the textareas  -->

<script>

myOnce123 = true    // so textareas are only clicked once


function myTextGrow(myT, myB){
   var myCursorStart = document.getElementById(myT).selectionStart
   var myCursorEnd = document.getElementById(myT).selectionEnd

   myDivName = myB.replace('Code','')
   document.getElementById(myT).value = '\x3Cscript src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.13.1"> \x3C/script> \n\n' + document.getElementById(myB).innerHTML 
   document.getElementById(myT).value += '<div id=\''+myDivName+'\'>...</div><br>'     
   setTimeout(function() {
      while (  document.getElementById(myT).clientHeight < document.getElementById(myT).scrollHeight){                                                                                                                                              
          document.getElementById(myT).rows += 3; 
      } 
   }, 100)

  document.getElementById(myT).selectionStart = myCursorStart
  document.getElementById(myT).selectionEnd = myCursorEnd

}  


</script>  
 
 
</body>
